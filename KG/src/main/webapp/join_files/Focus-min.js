function Focus(a,b,c){if(this.setOption(c),this.imgs="string"==typeof a?Kg.$C(a):a,this.ctrs="string"==typeof b?Kg.$C(b):b,this.l=this.imgs.length,this.timer=null,"fade"===this.option.effect&&this.ctrs)for(var d=0;d<this.l;d++)Kg.addEvent(this.ctrs[d],this.option.event,Kg.bind(function(a){this.over(a)},this,d)),Kg.addEvent(this.ctrs[d],"mouseout",Kg.bind(function(){this.start()},this)),Kg.addEvent(this.ctrs[d],"mouseover",Kg.bind(function(){clearTimeout(this.timer)},this)),Kg.addEvent(this.imgs[d],"mouseover",Kg.bind(function(){clearTimeout(this.timer)},this)),Kg.addEvent(this.imgs[d],"mouseout",Kg.bind(function(){this.start()},this));if("scroll"===this.option.effect){this.father=this.imgs[0].parentNode,this.size="Left"===this.option.scrollDir?this.imgs[0].offsetWidth:this.imgs[0].offsetHeight,2==this.option.scrollMode&&(this.father.innerHTML+=this.father.innerHTML,this.imgs="string"==typeof a?Kg.$C(a):a,this.l=this.imgs.length);for(var d=0;d<this.l;d++)this.imgs[d].style.position="absolute",this.imgs[d].style[this.option.scrollDir.toLowerCase()]=d*this.size+"px",this.ctrs&&this.ctrs[d]&&Kg.addEvent(this.ctrs[d],this.option.event,Kg.bind(function(a){a=this.currentIndex>this.realLength-1?a+this.realLength:a,this.over(a)},this,d))}this.realLength=2==this.option.scrollMode?this.l/2:this.l,this.currentIndex="random"===this.option.index?parseInt(Math.random()*this.realLength):this.option.index,this.ctrs&&(this.ctrs[this.currentIndex].className+=" current"),"fade"===this.option.effect?this.imgs[this.currentIndex].style.display="block":this.father["scroll"+this.option.scrollDir]=this.size*this.currentIndex,this.start()}Focus.prototype.setOption=function(a){this.option={event:"click",effect:"fade",scrollDir:"Left",scrollSpeed:.1,scrollMode:1,timeout:3e3,index:0,onstart:null,callback:null},Kg.extend(this.option,a||{},!0)},Focus.prototype.start=function(){this.timer=setTimeout(Kg.bind(this.change,this),this.option.timeout)},Focus.prototype.change=function(){if("fade"===this.option.effect){var a=Kg.UA.Ie?3:1,b=this,c=this.imgs[this.currentIndex];this.ctrs&&(this.ctrs[this.currentIndex].className=this.ctrs[this.currentIndex].className.replace(/\s*current/,""));var d=this.currentIndex===this.l-1?this.imgs[this.currentIndex=0]:this.imgs[++this.currentIndex];this.ctrs&&(this.ctrs[this.currentIndex].className+=" current"),c.style.zIndex=100,d.style.cssText="display:block; z-index:99",this.option.onstart&&this.option.onstart(this),c.timer=Kg.fadeout(c,1,a,function(){b.reset(),b.start(),b.option.callback&&b.option.callback(this)})}if("scroll"===this.option.effect){var e=Kg.UA.Ie?this.option.scrollSpeed:this.option.scrollSpeed-.04;2==this.option.scrollMode&&this.currentIndex==this.l-1&&(this.father["scroll"+this.option.scrollDir]=(this.realLength-1)*this.size,this.currentIndex=this.realLength-1),this.ctrs&&(this.ctrs[this.currentIndex%this.realLength].className=this.ctrs[this.currentIndex%this.realLength].className.replace(/\s*current/,"")),this.currentIndex===this.l-1?this.currentIndex=0:++this.currentIndex,this.ctrs&&(this.ctrs[this.currentIndex%this.realLength].className+=" current");var f=this.father["scroll"+this.option.scrollDir],g=this.currentIndex*this.size,b=this;this.option.onstart&&this.option.onstart(this),this.timer=Kg.slide(this.father,"scroll"+this.option.scrollDir,f,g,e,function(){clearInterval(b.timer),b.option.callback&&b.option.callback(b),b.start()})}},Focus.prototype.reset=function(a){var a=0===a?0:a||(0===this.currentIndex?this.l-1:this.currentIndex-1),b=this.imgs[a];b.style.cssText="display:none; z-index:1",clearInterval(b.timer),Kg.setOpacity(b,100)},Focus.prototype.over=function(a){if(clearTimeout(this.timer),a==this.currentIndex)return!1;if("fade"===this.option.effect){var b=Kg.UA.Ie?3:1,c=this.currentIndex,d=this.imgs[c],e=this.imgs[a],f=this;d.style.zIndex=1e3,clearInterval(d.timer),clearInterval(e.timer),Kg.setOpacity(d,100),e.style.cssText="display:block; z-index:999",this.ctrs&&(this.ctrs[this.currentIndex].className=this.ctrs[this.currentIndex].className.replace(/\s*current/,""),this.ctrs[a].className+=" current"),this.currentIndex=a,this.option.onstart&&this.option.onstart(this),d.timer=Kg.fadeout(d,1,b,function(){f.reset(c),f.option.callback&&f.option.callback(this)})}if("scroll"===this.option.effect){var g=Kg.UA.Ie?this.option.scrollSpeed:this.option.scrollSpeed-.04;2==this.option.scrollMode&&(this.currentIndex==this.l-1&&0==a&&(this.father["scroll"+this.option.scrollDir]=(this.realLength-1)*this.size,a=this.realLength),0==this.currentIndex&&a==this.l-1&&(this.father["scroll"+this.option.scrollDir]=this.realLength*this.size,a=this.realLength-1)),this.ctrs&&(this.ctrs[this.currentIndex%this.realLength].className=this.ctrs[this.currentIndex%this.realLength].className.replace(/\s*current/,"")),this.currentIndex=a,this.ctrs&&(this.ctrs[this.currentIndex%this.realLength].className+=" current");var h=this.father["scroll"+this.option.scrollDir],i=this.currentIndex*this.size,f=this;this.option.onstart&&this.option.onstart(this),this.timer=Kg.slide(this.father,"scroll"+this.option.scrollDir,h,i,g,function(){clearInterval(f.timer),f.option.callback&&f.option.callback(f),f.start()})}},Focus.prototype.prev=function(){var a=0===this.currentIndex?this.l-1:this.currentIndex-1;this.over(a),"fade"===this.option.effect&&this.start()},Focus.prototype.next=function(){var a=this.currentIndex===this.l-1?0:this.currentIndex+1;this.over(a),"fade"===this.option.effect&&this.start()};